# This file is part of tad-multicharge.
#
# SPDX-Identifier: Apache-2.0
# Copyright (C) 2024 Grimme Group
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
"""
Data for testing D4 coordination number (taken from D4 testsuite).
"""
from __future__ import annotations

import torch
from tad_mctc.data.molecules import merge_nested_dicts, mols

from tad_multicharge.typing import Molecule, Tensor, TypedDict


class Refs(TypedDict):
    """Format of reference values."""

    grad: Tensor
    """Nuclear gradient (reference with TPSS0 parameters)."""


class Record(Molecule, Refs):
    """Store for molecular information and reference values."""


refs: dict[str, Refs] = {
    "LiH": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        +0.0000000000000000e00,
                        +0.0000000000000000e00,
                        -1.2302277945431074e-02,
                    ],
                    [
                        +0.0000000000000000e00,
                        +0.0000000000000000e00,
                        +1.2302277945431074e-02,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "SiH4": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        -9.0537536095539402e-19,
                        -8.9711075080175710e-19,
                        -8.9711075080175710e-19,
                    ],
                    [
                        +2.5699119958478493e-04,
                        +2.5699119958478493e-04,
                        -2.5699119958478488e-04,
                    ],
                    [
                        -2.5699119958478412e-04,
                        -2.5699119958478412e-04,
                        -2.5699119958478412e-04,
                    ],
                    [
                        +2.5699119958478493e-04,
                        -2.5699119958478488e-04,
                        +2.5699119958478493e-04,
                    ],
                    [
                        -2.5699119958478488e-04,
                        +2.5699119958478493e-04,
                        +2.5699119958478493e-04,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "AmF3": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        -7.4021411463984915e-06,
                        +3.8177976052419793e-07,
                        +9.3536773201791656e-03,
                    ],
                    [
                        -5.6525568841740773e-03,
                        -1.5287470820034010e-03,
                        -3.1230771573808585e-03,
                    ],
                    [
                        +1.5072007235716486e-03,
                        +5.6622432730357572e-03,
                        -3.1153927236688456e-03,
                    ],
                    [
                        +4.1527583017488285e-03,
                        -4.1338779707928803e-03,
                        -3.1152074391294620e-03,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "PbH4-BiH3": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        +2.7391361297140784e-09,
                        +3.2488573299127035e-05,
                        +6.2870178347078794e-20,
                    ],
                    [
                        -5.5883738115394956e-05,
                        +1.7063470783804067e-05,
                        -7.7368226740032970e-21,
                    ],
                    [
                        +2.7940509984088580e-05,
                        +1.7062534189631494e-05,
                        +4.8394450812532972e-05,
                    ],
                    [
                        +2.7940509984088596e-05,
                        +1.7062534189631542e-05,
                        -4.8394450812533006e-05,
                    ],
                    [
                        -2.1754844657862412e-11,
                        -9.3095225586217040e-05,
                        -3.5238321304723560e-21,
                    ],
                    [
                        +6.0074327187720391e-10,
                        -6.4103751766856563e-05,
                        -4.3032485808259733e-21,
                    ],
                    [
                        -1.1045324886975612e-05,
                        +2.4507140765856783e-05,
                        +1.9131050538912299e-05,
                    ],
                    [
                        +2.2090049796612069e-05,
                        +2.4507583359165950e-05,
                        +3.2074513853891939e-22,
                    ],
                    [
                        -1.1045324886975612e-05,
                        +2.4507140765856793e-05,
                        -1.9131050538912306e-05,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "MB16_43_01": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        +3.0255267464712538e-02,
                        -3.5679513684768703e-02,
                        -9.9725430968097047e-03,
                    ],
                    [
                        +1.4053547152460639e-03,
                        +5.1973983709450858e-04,
                        -6.1254653813066291e-04,
                    ],
                    [
                        -3.9205056413805272e-03,
                        -1.1799400131945314e-03,
                        +1.5169791203764901e-02,
                    ],
                    [
                        -1.2639986174027328e-02,
                        +1.0530025245702641e-02,
                        +1.0913176639729271e-02,
                    ],
                    [
                        +1.2195997425844386e-03,
                        +1.4807421019240200e-03,
                        -2.0750515826571795e-03,
                    ],
                    [
                        -1.3874953495617261e-02,
                        -1.0044936560830841e-02,
                        -5.0407338816790600e-03,
                    ],
                    [
                        -2.6729377287261521e-03,
                        +6.8283441374700617e-04,
                        +2.5730497392527944e-03,
                    ],
                    [
                        -1.6159161697882979e-02,
                        -1.2064177209436547e-02,
                        +1.7743565091426508e-02,
                    ],
                    [
                        -6.8395411331776089e-03,
                        +9.5114814875395053e-04,
                        +4.7009594270575805e-03,
                    ],
                    [
                        +2.2947724189977349e-02,
                        +8.4367319340393678e-03,
                        -9.2509986588472908e-03,
                    ],
                    [
                        -3.9069026640020177e-03,
                        -3.7452918258164243e-03,
                        +1.8307791184629340e-02,
                    ],
                    [
                        +1.2295112507608910e-04,
                        +6.0783645752460127e-04,
                        -1.4518596991648023e-04,
                    ],
                    [
                        -7.0759822116250766e-03,
                        +1.3807811088926058e-03,
                        +1.4106930140486760e-03,
                    ],
                    [
                        +2.4457775020027619e-03,
                        +1.7365046452605629e-03,
                        -9.7079172590843268e-03,
                    ],
                    [
                        +1.3519066719010459e-02,
                        +1.9269028843359477e-02,
                        -1.1422812693779793e-02,
                    ],
                    [
                        -4.8257707121707408e-03,
                        +1.7118486557748312e-02,
                        -2.2591236619004577e-02,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "MB16_43_02": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        -1.2709279001357605e-04,
                        -4.3293309527702150e-04,
                        -2.0697155797342677e-03,
                    ],
                    [
                        +5.2806220187984606e-03,
                        +4.9977194973739167e-03,
                        -6.0806895535748138e-03,
                    ],
                    [
                        -9.9027785165240975e-04,
                        -3.1738324415274380e-03,
                        -4.5416129030337863e-04,
                    ],
                    [
                        -9.7110506538283514e-03,
                        +2.0671457381561558e-03,
                        -3.1969618354395934e-02,
                    ],
                    [
                        -3.6669341559387881e-03,
                        -1.3393312088949259e-02,
                        +9.8363596717015150e-03,
                    ],
                    [
                        -2.2983418603584110e-03,
                        -1.6993274241402807e-02,
                        +1.4214327106011136e-02,
                    ],
                    [
                        +3.1970766993149609e-04,
                        -1.8612304853144993e-03,
                        +1.0373571422161274e-03,
                    ],
                    [
                        +6.6913497771610431e-05,
                        +1.7494811457255655e-03,
                        +1.4816438185308043e-03,
                    ],
                    [
                        -2.7108574129509479e-03,
                        +7.2415585106684072e-03,
                        -2.1735795490861087e-03,
                    ],
                    [
                        +1.7494598908680822e-02,
                        +7.4281124360776121e-03,
                        +9.0874356968390860e-03,
                    ],
                    [
                        -5.8928974263352174e-03,
                        +6.8344609012888991e-04,
                        +2.7101462285118940e-03,
                    ],
                    [
                        -3.7632463143824632e-03,
                        -3.4811130110300988e-03,
                        +1.7857192063339820e-02,
                    ],
                    [
                        -4.6523604466950511e-03,
                        +2.0361684288726714e-02,
                        -1.0358233314462990e-02,
                    ],
                    [
                        +2.1815927290452330e-04,
                        -3.4862562825831270e-04,
                        +1.9346844967726664e-04,
                    ],
                    [
                        +4.2630007506706197e-03,
                        -9.6764522445748000e-04,
                        -1.6633013659588674e-03,
                    ],
                    [
                        +6.1700567933976715e-03,
                        -3.8771814906403382e-03,
                        -1.6486311693112992e-03,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "vancoh2": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        +1.8788403949746722e-03,
                        -4.4984738061267090e-04,
                        -1.1638351813217560e-03,
                    ],
                    [
                        -2.0916852349303025e-03,
                        -1.0784743310646398e-04,
                        +1.3082172655697133e-03,
                    ],
                    [
                        -1.3292394459064663e-03,
                        -7.3759641201184812e-04,
                        +1.9092947699844460e-03,
                    ],
                    [
                        +1.5487900871375109e-04,
                        -2.3972409293938725e-04,
                        +1.9140099172903910e-04,
                    ],
                    [
                        +1.3039446555257084e-03,
                        +1.4467972605590432e-04,
                        -1.1079121303497325e-03,
                    ],
                    [
                        +1.4367787310697671e-03,
                        +6.9423876753528491e-05,
                        -1.7521984998863369e-03,
                    ],
                    [
                        -7.9349844024086060e-04,
                        +7.1692342650246980e-04,
                        -7.7156241042271323e-04,
                    ],
                    [
                        -6.2349903641745891e-04,
                        -1.6943496636115469e-03,
                        +1.3160867069958889e-03,
                    ],
                    [
                        +1.0333752789680286e-03,
                        +7.2214270882593658e-04,
                        -1.0646069146059290e-05,
                    ],
                    [
                        +1.2315086134016585e-03,
                        -6.0811046712450122e-04,
                        +7.6310730618640659e-04,
                    ],
                    [
                        -3.4347786840984964e-04,
                        +1.2258005151019975e-05,
                        -2.0976814918055261e-04,
                    ],
                    [
                        -1.8591255505227317e-03,
                        -9.5360484736364446e-04,
                        +2.8996878721746535e-04,
                    ],
                    [
                        -9.7634731657214948e-04,
                        +9.0865260218044746e-04,
                        -1.1044496490282233e-03,
                    ],
                    [
                        +4.7938284537414394e-04,
                        +1.9428551537710001e-03,
                        -6.2517990792249078e-04,
                    ],
                    [
                        -2.6403967536667099e-03,
                        -1.6720269173661726e-04,
                        +2.2597515992301975e-03,
                    ],
                    [
                        +1.6051060301846703e-03,
                        +1.8094625526406535e-03,
                        -3.1772428485006585e-03,
                    ],
                    [
                        +1.4099956155342881e-03,
                        +1.3220577177110494e-03,
                        -2.4443985458817877e-03,
                    ],
                    [
                        +1.8190958883852645e-04,
                        +2.3870905543853124e-04,
                        +5.5223894574109325e-05,
                    ],
                    [
                        -3.4938534302817885e-04,
                        +4.4708620212406414e-04,
                        +1.0757673132778050e-03,
                    ],
                    [
                        -8.0281257599579945e-05,
                        +1.0256283787454898e-03,
                        -4.4655880370441677e-04,
                    ],
                    [
                        +1.6184512264650662e-03,
                        -2.6927640965408906e-03,
                        -1.5598227584567989e-03,
                    ],
                    [
                        -1.4092274732693025e-03,
                        +2.1106736822266159e-03,
                        -5.6179036369115563e-05,
                    ],
                    [
                        +7.2204082846882953e-04,
                        -8.7935433806780362e-04,
                        -1.4978104296580063e-04,
                    ],
                    [
                        +7.5462569618523542e-04,
                        -1.8864530399017162e-03,
                        +7.8862286718521746e-05,
                    ],
                    [
                        -1.2689684269848896e-03,
                        -5.5486675973007953e-05,
                        +1.5614298069826691e-03,
                    ],
                    [
                        -4.8201774595379113e-03,
                        -2.4114327779592007e-02,
                        +1.9517158097432465e-02,
                    ],
                    [
                        -1.4714964659979460e-02,
                        +1.6192520211253850e-02,
                        -9.2294704808397153e-03,
                    ],
                    [
                        +1.9972531081575904e-02,
                        +7.3795087862590760e-03,
                        -1.1254475982055718e-02,
                    ],
                    [
                        +3.9558443001485224e-03,
                        -1.3564476232274283e-04,
                        -2.5285020113059364e-03,
                    ],
                    [
                        -1.3070803385568258e-03,
                        +8.9681625034588523e-04,
                        +1.6832578279838315e-04,
                    ],
                    [
                        -1.3853102324189340e-03,
                        -6.7631280940330825e-04,
                        +5.8218614067667468e-04,
                    ],
                    [
                        -5.7603597849750223e-04,
                        +7.3936423201857932e-04,
                        +3.5056756795309426e-04,
                    ],
                    [
                        -8.4620659130512212e-04,
                        +7.1083240156519473e-04,
                        +1.6488580269424699e-04,
                    ],
                    [
                        -1.7726830048917415e-03,
                        -2.3341943527212132e-02,
                        -4.3365444573083018e-03,
                    ],
                    [
                        +3.1668470894766869e-03,
                        +1.9747699836827181e-02,
                        +5.4193531538540953e-03,
                    ],
                    [
                        -1.7981466456365805e-03,
                        +2.0334780678860938e-04,
                        +1.0041349678832163e-03,
                    ],
                    [
                        -5.9361577230632531e-05,
                        +4.6938037092563367e-04,
                        +3.3204968706819781e-04,
                    ],
                    [
                        +1.4181311052748595e-04,
                        -3.2081433949628989e-03,
                        -1.3560497349037832e-03,
                    ],
                    [
                        +5.0929557871142166e-04,
                        +1.4457822719533178e-03,
                        +7.3096091900394695e-04,
                    ],
                    [
                        +1.4467999316537496e-04,
                        +1.0222604487622061e-03,
                        +6.5137257091486844e-04,
                    ],
                    [
                        +1.3871439988629643e-04,
                        -1.0636229872621333e-03,
                        +5.2203263010012937e-04,
                    ],
                    [
                        -2.1104799150693308e-03,
                        +8.8837095459816536e-04,
                        -5.1820171213506126e-06,
                    ],
                    [
                        +1.0054784005238345e-04,
                        +1.8472201183455403e-03,
                        -1.7887560914771742e-03,
                    ],
                    [
                        +1.3313026486044322e-03,
                        -1.8257064687151362e-03,
                        -7.3005633888432032e-04,
                    ],
                    [
                        +3.1259701470268169e-04,
                        +4.5780895807233573e-05,
                        -6.5860148537950707e-05,
                    ],
                    [
                        +7.3862966830448226e-04,
                        -3.7259156080312781e-04,
                        -1.8957698855194044e-03,
                    ],
                    [
                        +1.6428116214778972e-02,
                        -1.5757942920123346e-02,
                        -3.4571850679029634e-03,
                    ],
                    [
                        -1.4779390655795444e-02,
                        +1.5102987611212411e-02,
                        +6.7914967860782513e-03,
                    ],
                    [
                        -1.3489725893020383e-05,
                        -3.7647636383018890e-04,
                        +2.4554444065872906e-04,
                    ],
                    [
                        +5.5976248903998674e-03,
                        -1.6722658636337855e-02,
                        +1.2828463206433950e-02,
                    ],
                    [
                        -6.4938124683179051e-03,
                        +1.4304672981179605e-02,
                        -1.6624195701875111e-02,
                    ],
                    [
                        -3.9260251809819654e-04,
                        -2.1353417566793314e-06,
                        +2.3412337752796992e-03,
                    ],
                    [
                        -4.8207791748588154e-05,
                        -4.7201347391118132e-04,
                        +3.0866536822292276e-04,
                    ],
                    [
                        -1.2570940338833385e-03,
                        +3.8625187588629459e-04,
                        +3.9904296568123239e-05,
                    ],
                    [
                        +1.9059232568871122e-03,
                        -1.5448347259034656e-02,
                        +1.4354603755374833e-02,
                    ],
                    [
                        -6.3843487893806040e-03,
                        +1.7265500812489135e-02,
                        -1.3387914934629904e-02,
                    ],
                    [
                        +2.4438793748246170e-03,
                        -1.1566893904255277e-03,
                        -4.3074927522181980e-04,
                    ],
                    [
                        +2.1249324312184099e-03,
                        -1.2034945524931628e-03,
                        +5.7734989371389456e-04,
                    ],
                    [
                        -9.1480940575882372e-04,
                        +3.1628255862115707e-04,
                        +1.3388399931514440e-03,
                    ],
                    [
                        +1.5699787542102083e-04,
                        -2.1186563687971591e-03,
                        +1.1761380438357956e-03,
                    ],
                    [
                        -3.9915326589785009e-04,
                        -9.9822808152767316e-04,
                        +1.1886138378731869e-03,
                    ],
                    [
                        +1.3609174149182112e-03,
                        +8.9251951598317636e-04,
                        +2.6411313093359238e-04,
                    ],
                    [
                        +1.1080008514242935e-03,
                        -6.8442674492616331e-04,
                        -1.5016130305498152e-03,
                    ],
                    [
                        +5.4783739513040010e-04,
                        -1.4526201169674480e-03,
                        -1.7383759798854784e-03,
                    ],
                    [
                        -1.6422539453664274e-04,
                        -3.3879723951388589e-04,
                        -5.7737703793221936e-05,
                    ],
                    [
                        -7.5119780639687299e-04,
                        +2.3871982803132894e-04,
                        +1.5674322798832495e-03,
                    ],
                    [
                        -4.3789904695605889e-04,
                        +4.8401811587510076e-04,
                        +1.9553221199599589e-03,
                    ],
                    [
                        +3.3692141534073724e-04,
                        -1.1602078947051887e-04,
                        -1.5686402505689465e-03,
                    ],
                    [
                        +1.2160251296573016e-04,
                        -1.4482637367632788e-03,
                        -4.9411748805592225e-04,
                    ],
                    [
                        -5.2275885267842321e-04,
                        +4.3915859413752519e-04,
                        +3.7214093139963935e-04,
                    ],
                    [
                        +9.0655444640113118e-04,
                        +4.4819796205376140e-03,
                        +2.0972548036791726e-02,
                    ],
                    [
                        +2.8373284891566640e-03,
                        -8.3065698426974029e-03,
                        -1.9201419474266328e-02,
                    ],
                    [
                        -2.0525169256553483e-03,
                        +1.1751865623710340e-03,
                        +1.1584690282827278e-03,
                    ],
                    [
                        +1.1343933604323032e-03,
                        +3.1314960158784476e-05,
                        +5.8890923758210089e-04,
                    ],
                    [
                        +1.1115319318080786e-02,
                        +1.8059512237808852e-02,
                        -1.2971369374226794e-03,
                    ],
                    [
                        -6.1944931199391269e-03,
                        -1.1505567384953578e-03,
                        -5.9686081716538576e-04,
                    ],
                    [
                        +2.8266997274610153e-03,
                        +2.4959043540119792e-03,
                        +1.7391418591985708e-03,
                    ],
                    [
                        +1.1304821578506923e-05,
                        +8.2842971904530528e-04,
                        -6.1484389291645926e-05,
                    ],
                    [
                        -3.7818467439799751e-04,
                        +5.1073771618388275e-05,
                        -6.4159439216446366e-04,
                    ],
                    [
                        -2.1089918984650482e-04,
                        +1.3623440605626080e-03,
                        -4.6511550456568914e-04,
                    ],
                    [
                        -7.6725990644490493e-05,
                        +5.9109545481329227e-05,
                        -1.0674625294085115e-07,
                    ],
                    [
                        -3.9297510040446978e-04,
                        -5.0543313431938158e-04,
                        +1.6011402714054964e-03,
                    ],
                    [
                        +1.0575825836744992e-03,
                        -1.2950382425421655e-03,
                        -7.9535872423723545e-05,
                    ],
                    [
                        +1.1121289042630141e-03,
                        -1.5751134978717865e-03,
                        -3.9691975919353294e-04,
                    ],
                    [
                        -6.6927415838783126e-04,
                        +1.1936761482551981e-03,
                        +5.7535389798081993e-04,
                    ],
                    [
                        -1.7186355759543030e-03,
                        +1.3704290460986059e-03,
                        +3.7296937984697827e-04,
                    ],
                    [
                        -1.3796130290538378e-02,
                        +1.4354967530267274e-02,
                        +4.1752246701713186e-03,
                    ],
                    [
                        +1.4773096098986296e-02,
                        -1.4973172329893782e-02,
                        -6.4107939099483160e-03,
                    ],
                    [
                        +7.1387914960540153e-05,
                        -1.8037208119871858e-04,
                        -7.7062196044902522e-05,
                    ],
                    [
                        +5.8812496864635724e-05,
                        -4.7966795112132542e-05,
                        +2.3912828468964341e-04,
                    ],
                    [
                        -1.5043267772012791e-03,
                        -4.1431710510854192e-04,
                        -4.7223752592052422e-04,
                    ],
                    [
                        -7.4362856480452834e-05,
                        +8.3188761112301234e-04,
                        +7.6283817207206900e-04,
                    ],
                    [
                        +4.3028000181948516e-04,
                        +6.7368186653893227e-04,
                        +4.8266345108885538e-04,
                    ],
                    [
                        +4.3051723044181043e-04,
                        -1.6319328297081584e-04,
                        +6.7158038946344616e-04,
                    ],
                    [
                        +1.3684065556999083e-02,
                        -8.8410967386926172e-03,
                        -1.5963637662913501e-02,
                    ],
                    [
                        -1.0573369941111634e-02,
                        +1.1292764281212460e-02,
                        +1.2761753068070616e-02,
                    ],
                    [
                        -7.8715513545888802e-04,
                        -4.8400335800202662e-04,
                        -3.1686086652284504e-04,
                    ],
                    [
                        -1.9371953956218099e-02,
                        -3.7487719874510486e-03,
                        -9.8502105015995933e-03,
                    ],
                    [
                        +2.0141371115485723e-02,
                        +3.2029139900115111e-03,
                        +9.3537676532241178e-03,
                    ],
                    [
                        +1.4505506739347887e-03,
                        +2.6326153090008148e-04,
                        -2.9972984063431893e-04,
                    ],
                    [
                        +1.5589208387021727e-03,
                        -7.2122926743064123e-05,
                        -1.8708068816765176e-03,
                    ],
                    [
                        +5.6807899076124794e-03,
                        -1.8110892275724197e-02,
                        -6.9510891011419461e-03,
                    ],
                    [
                        -2.1257458686364055e-03,
                        +2.5899576508973655e-03,
                        +6.5887592591606196e-03,
                    ],
                    [
                        +8.4369513825878018e-04,
                        +2.1263432477935350e-03,
                        -6.6411216179972131e-03,
                    ],
                    [
                        -4.2398716929686010e-03,
                        +1.2843197386756483e-02,
                        +7.7492459542302609e-03,
                    ],
                    [
                        +2.0697329084137187e-03,
                        -4.2091172014896384e-03,
                        +3.4167129716437933e-03,
                    ],
                    [
                        -8.8021680969226958e-04,
                        +3.1810053417554514e-03,
                        -4.7063192286857123e-03,
                    ],
                    [
                        +3.9851116578185734e-03,
                        -1.6122108898223252e-02,
                        +9.2538815009210566e-03,
                    ],
                    [
                        -5.1491754823726477e-03,
                        +2.0075017425095598e-02,
                        -9.3044718324318248e-03,
                    ],
                    [
                        +7.8481358238611544e-04,
                        -5.2422523605189169e-05,
                        -1.8623117566809984e-03,
                    ],
                    [
                        -1.2564714704353319e-03,
                        -1.9605306235910636e-03,
                        +3.3015215760892462e-04,
                    ],
                    [
                        -3.4149145417244234e-03,
                        -6.1659134704872727e-03,
                        -1.5421999306948497e-02,
                    ],
                    [
                        +2.8624112644438145e-03,
                        -1.9056191812412528e-03,
                        -4.7565293264646129e-03,
                    ],
                    [
                        +8.4522305620260473e-04,
                        +2.0356777636548989e-03,
                        +1.3936003986934997e-03,
                    ],
                    [
                        +1.9277088277146602e-03,
                        -1.0920885615027438e-03,
                        +9.4305270696969188e-04,
                    ],
                    [
                        +1.7212166037287417e-02,
                        -6.8573557952409693e-03,
                        -9.1511850279171383e-03,
                    ],
                    [
                        -5.7881602685376154e-03,
                        +2.8061593784001007e-03,
                        -2.8986719319988928e-03,
                    ],
                    [
                        -5.4442656162528478e-04,
                        +1.4264301460196569e-03,
                        +3.7292820608002602e-03,
                    ],
                    [
                        +1.6514059906948058e-03,
                        +4.6709482753710106e-04,
                        -7.8343757507613884e-04,
                    ],
                    [
                        -3.6301028922564775e-04,
                        +1.7542179238163581e-02,
                        -1.2279207134285416e-02,
                    ],
                    [
                        -5.4938288346934819e-03,
                        -4.5448471135542661e-03,
                        +2.9850917574617756e-03,
                    ],
                    [
                        +2.3552722455067810e-03,
                        +2.0565500883768886e-03,
                        -2.0363584437140883e-03,
                    ],
                    [
                        +6.2809384315372428e-05,
                        +1.9379492175484374e-04,
                        -1.3876359272135333e-03,
                    ],
                    [
                        -1.8394679272624087e-02,
                        -1.0151078237757112e-02,
                        -5.5595882354555533e-03,
                    ],
                    [
                        +3.7930232863200657e-03,
                        +1.1283993734153264e-03,
                        +5.6689688086238423e-03,
                    ],
                    [
                        -1.1527606390834381e-03,
                        +2.4972970781786227e-03,
                        +3.9529726093493328e-05,
                    ],
                    [
                        +2.5278455788458470e-04,
                        -6.4089973799791040e-04,
                        -1.2856631683501995e-05,
                    ],
                    [
                        -1.4411471901935835e-02,
                        -4.2283491977531109e-03,
                        +8.8976129200933948e-03,
                    ],
                    [
                        +2.3807862973070017e-03,
                        -2.5415441937061290e-03,
                        +7.9732611461891690e-04,
                    ],
                    [
                        -1.9082319683129355e-03,
                        +1.3341734531386142e-03,
                        +6.7865380274122008e-05,
                    ],
                    [
                        -1.1971861334890126e-03,
                        +1.7756491636957104e-03,
                        -3.8432552012862033e-04,
                    ],
                    [
                        -1.3253006295257631e-03,
                        +1.8422859935674711e-03,
                        -3.1381950397433233e-04,
                    ],
                    [
                        +1.5959932339106715e-02,
                        +3.5515141019834828e-03,
                        -9.1051943867253050e-03,
                    ],
                    [
                        -7.8079718914575728e-04,
                        +1.6825848725024522e-03,
                        +1.4720961493916770e-03,
                    ],
                    [
                        +5.8853186133631650e-04,
                        -6.7119559806982953e-04,
                        -1.2945667971791320e-03,
                    ],
                    [
                        +3.0542317101300642e-04,
                        -8.2914650610673856e-04,
                        -1.8320849389586512e-04,
                    ],
                    [
                        +1.0588967313671963e-03,
                        +6.7594971089705185e-04,
                        -5.2168252513754064e-04,
                    ],
                    [
                        -2.8707460725404252e-04,
                        -2.1468513968591089e-03,
                        -2.4237948654951377e-03,
                    ],
                    [
                        -1.3433622305554827e-04,
                        +6.7030920449887010e-04,
                        +1.6958238320035790e-03,
                    ],
                    [
                        -2.2193947209282766e-05,
                        +2.8731486841322197e-04,
                        +9.7091946232290651e-04,
                    ],
                    [
                        -2.3186209960967199e-04,
                        +9.0819267557909120e-04,
                        +1.2225317168189846e-03,
                    ],
                    [
                        -1.2995309552510119e-03,
                        +2.4868891279553394e-03,
                        -6.4138430875963607e-04,
                    ],
                    [
                        +1.0892230732383344e-04,
                        -1.2610808270226033e-03,
                        +3.2152275981316250e-04,
                    ],
                    [
                        +2.0435028334048772e-04,
                        -5.3895877940647249e-04,
                        +8.3198979772166443e-04,
                    ],
                    [
                        -2.1772360704888443e-04,
                        -6.7203424741640373e-04,
                        -1.2218812566176673e-04,
                    ],
                    [
                        -1.6484093932145161e-03,
                        -6.2563298717648562e-04,
                        +5.7329270392463385e-04,
                    ],
                    [
                        -8.5189275309860597e-04,
                        -1.4555789957980060e-03,
                        +1.3653628701395986e-03,
                    ],
                    [
                        +1.3098223966910922e-02,
                        +6.5325145232250203e-03,
                        +8.1629687808386156e-03,
                    ],
                    [
                        -1.1423687024836504e-04,
                        +2.5989474549757984e-04,
                        -1.3004149865297884e-03,
                    ],
                    [
                        +7.3706375595948700e-04,
                        +1.2386481230429992e-04,
                        -6.6214530007898298e-04,
                    ],
                    [
                        +2.2179010359746408e-03,
                        -6.6344950785534613e-03,
                        -2.0263192210191520e-02,
                    ],
                    [
                        -6.5773845566143765e-03,
                        +2.8963344515109410e-03,
                        +1.6587318642455835e-02,
                    ],
                    [
                        +2.3908461258896657e-03,
                        +2.1736988434537324e-04,
                        -7.3219760139696703e-04,
                    ],
                    [
                        -1.1431245849891527e-03,
                        -1.4083607152899124e-02,
                        +1.2767548884098668e-02,
                    ],
                    [
                        -2.0459185330805765e-03,
                        -4.6244320159566913e-04,
                        +2.1994971863079776e-03,
                    ],
                    [
                        +4.9244799257990041e-03,
                        +5.2580381149166231e-04,
                        -7.1350952792241778e-03,
                    ],
                    [
                        +9.8022928774181128e-04,
                        +6.8624527433928167e-03,
                        -1.5931275978256177e-03,
                    ],
                    [
                        +3.8522309260998725e-03,
                        -3.2442128460228543e-02,
                        +3.5681620694592705e-03,
                    ],
                    [
                        -1.3009227145312087e-02,
                        +1.4284004140176141e-02,
                        +1.8511789812827997e-02,
                    ],
                    [
                        +6.5274150692108826e-03,
                        +1.5367171820310577e-02,
                        -1.7796271711057542e-02,
                    ],
                    [
                        +6.1171792222989576e-05,
                        +6.5991403403084688e-04,
                        -8.4001085912924656e-04,
                    ],
                    [
                        +2.6778409894493635e-03,
                        +1.2740576817572957e-03,
                        -1.6484482799600792e-04,
                    ],
                    [
                        +1.2893117093645786e-03,
                        +7.4002392999348600e-04,
                        -6.9676916531745826e-04,
                    ],
                    [
                        -1.4967507751941604e-02,
                        +3.3616005146719250e-03,
                        +7.4245494065173058e-03,
                    ],
                    [
                        +2.1840389531800545e-03,
                        -1.6044919059026413e-03,
                        +1.9454012501529236e-03,
                    ],
                    [
                        +9.6489306639568613e-04,
                        +6.4422516891299931e-03,
                        +1.9089105280789682e-02,
                    ],
                    [
                        -3.2814582362509029e-04,
                        +1.1129670437236238e-03,
                        -2.5194050549225529e-04,
                    ],
                    [
                        -1.1535953164595762e-02,
                        -1.5523616565774098e-02,
                        +1.3907410453972723e-04,
                    ],
                    [
                        +2.0612128029820504e-03,
                        -1.0818803133965814e-03,
                        +7.3758758994192154e-04,
                    ],
                    [
                        +1.6461548429904013e-05,
                        +1.1675024353997115e-03,
                        +1.2417223539938761e-03,
                    ],
                    [
                        -8.2575755385983483e-04,
                        +6.9760304487436831e-04,
                        +1.4775854546887433e-03,
                    ],
                    [
                        +1.4922985616529476e-03,
                        +9.9515226394365341e-04,
                        -5.9393726811800599e-04,
                    ],
                    [
                        -1.7406311322716768e-03,
                        +7.4455326790324680e-04,
                        -4.7973276008213538e-04,
                    ],
                    [
                        -1.1989491598503751e-03,
                        +2.4578454421990154e-04,
                        +1.5242171087948844e-03,
                    ],
                    [
                        -8.6290961339940335e-04,
                        -1.1963672529637804e-03,
                        +1.0366312887920279e-03,
                    ],
                    [
                        +5.1847222348145585e-04,
                        +1.6463496235571699e-04,
                        -1.5003949629384269e-03,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "Ag2Cl22-": Refs(
        {
            "grad": torch.tensor(
                [],
                dtype=torch.double,
            ),
        }
    ),
    "ZnOOH-": Refs(
        {
            "grad": torch.tensor(
                [],
                dtype=torch.double,
            ),
        }
    ),
}


samples: dict[str, Record] = merge_nested_dicts(mols, refs)
